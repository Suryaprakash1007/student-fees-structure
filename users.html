<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Beautiful Table with Actions</title>
  <style>
    :root{
      --bg: #0f172a;         /* slate-900 */
      --panel: #111827;      /* gray-900 */
      --muted: #94a3b8;      /* slate-400 */
      --text: #e5e7eb;       /* gray-200 */
      --accent: #22d3ee;     /* cyan-400 */
      --accent-2: #a78bfa;   /* violet-400 */
      --ok: #10b981;         /* emerald-500 */
      --warn: #f59e0b;       /* amber-500 */
      --danger: #ef4444;     /* red-500 */
      --ring: rgba(34,211,238,.35);
      --row: rgba(255,255,255,0.02);
      --row-hover: rgba(255,255,255,0.06);
      --btn: rgba(255,255,255,0.06);
    }

    @media (prefers-color-scheme: light){
      :root{
        --bg: #f8fafc;
        --panel: #ffffff;
        --muted: #6b7280;
        --text: #0f172a;
        --row: rgba(2,6,23,0.02);
        --row-hover: rgba(2,6,23,0.06);
        --btn: rgba(2,6,23,0.06);
        --ring: rgba(79,70,229,.25);
      }
    }

    * { box-sizing: border-box }

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: radial-gradient(1200px 800px at 10% -10%, rgba(167,139,250,.18), transparent 60%),
                  radial-gradient(1000px 700px at 110% 10%, rgba(34,211,238,.16), transparent 60%),
                  var(--bg);
      color: var(--text);
      padding: clamp(16px, 4vw, 40px);
    }

    .wrap{
      max-width: 1100px;
      margin: 0 auto;
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      backdrop-filter: blur(8px);
      border: 1px solid rgba(255,255,255,.08);
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
      border-radius: 18px;
      overflow: hidden;
    }

    .header{
      display: flex; align-items: center; justify-content: space-between;
      padding: 18px 20px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: linear-gradient(180deg, rgba(255,255,255,.04), transparent);
    }
    .title{
      font-size: clamp(18px, 2vw, 22px);
      font-weight: 700;
      letter-spacing: .3px;
    }
    .search{
      display:flex; gap:10px; align-items:center;
    }
    .search input{
      background: var(--btn);
      border: 1px solid transparent;
      color: var(--text);
      padding: 10px 12px;
      border-radius: 12px;
      outline: none;
      min-width: 220px;
    }
    .search input:focus{
      border-color: var(--accent);
      box-shadow: 0 0 0 6px var(--ring);
    }
    .btn-primary{
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
      color: #0b1021;
      border: none;
      padding: 10px 14px;
      border-radius: 12px;
      font-weight: 700;
      cursor: pointer;
    }
    .btn-primary:focus-visible{
      outline: none;
      box-shadow: 0 0 0 6px var(--ring);
    }

    .table-wrap{
      overflow:auto;
      max-height: 60vh;
    }

    table{
      width: 100%;
      border-collapse: collapse;
      min-width: 760px;
    }
    thead th{
      position: sticky;
      top: 0;
      background: var(--panel);
      z-index: 1;
      text-align: left;
      font-weight: 700;
      letter-spacing:.25px;
      padding: 14px 16px;
      border-bottom: 1px solid rgba(255,255,255,.1);
    }
    tbody tr{
      background: var(--row);
      transition: background .2s ease, transform .06s ease;
    }
    tbody tr:hover{
      background: var(--row-hover);
    }
    td{
      padding: 14px 16px;
      border-bottom: 1px dashed rgba(255,255,255,.08);
      vertical-align: middle;
    }

    .badge{
      display:inline-block;
      padding: 6px 10px;
      font-size: 12px;
      border-radius: 999px;
      background: var(--btn);
      border: 1px solid rgba(255,255,255,.08);
    }
    .ok{ border-color: rgba(16,185,129,.4) }
    .warn{ border-color: rgba(245,158,11,.4) }
    .muted{ color: var(--muted) }

    .actions{
      display:flex; gap:10px;
    }
    .btn{
      display:inline-flex; align-items:center; gap:8px;
      background: var(--btn);
      border: 1px solid rgba(255,255,255,.12);
      color: var(--text);
      padding: 8px 12px;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: transform .08s ease, background .2s ease, border-color .2s ease;
    }
    .btn:hover{ transform: translateY(-1px) }
    .btn:active{ transform: translateY(0) scale(.98) }
    .btn:focus-visible{
      outline: none;
      box-shadow: 0 0 0 6px var(--ring);
    }
    .edit:hover{ border-color: rgba(34,211,238,.6) }
    .delete:hover{ border-color: rgba(239,68,68,.6) }

    .icon{ width: 16px; height: 16px; display:block }

    .foot{
      padding: 12px 16px;
      display:flex; justify-content: space-between; align-items:center;
      font-size: 14px; color: var(--muted);
    }

    /* Mobile stacking for very narrow screens */
    @media (max-width: 520px){
      thead{ display:none }
      table, tbody, tr, td { display:block; width:100% }
      tbody tr{ margin: 10px 12px; border-radius: 14px; overflow:hidden }
      td{ display:flex; justify-content: space-between; align-items:center; border:none; border-bottom:1px dashed rgba(255,255,255,.08) }
      td::before{
        content: attr(data-label);
        font-weight: 700;
        color: var(--muted);
        margin-right: 12px;
      }
      .actions{ justify-content:flex-end }
    }
    .my-btn {
  padding: 10px 20px;
  background-color: #4CAF50; /* Green */
  color: white;
  margin-top: 20px;
  border: none;
  border-radius: 8px;
  font-size: 15px;
  font-weight: 500;
  cursor: pointer;
  transition: background 0.3s ease, transform 0.2s ease;
}

.my-btn:hover {
  background-color: #45a049;
  transform: translateY(-2px);
}

.my-btn:active {
  transform: translateY(0);
}

  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="region" aria-label="Users table">
      <div class="header">
        <div class="title">Users</div>
        <div class="search">
          <input id="searchInput" type="search" placeholder="Search by name, email‚Ä¶" aria-label="Search users" />
          <button onclick="window.location.href='create-user.html'"class="btn-primary" id="addBtn">+ Add User</button>
        </div>
      </div>

      <div class="table-wrap">
        <table id="usersTable">
        <thead>
        <tr>
          <th>Name</th>
          <th>Register No</th>
          <th>Email</th>
          <th>Year</th>
          <th>Department</th>
          <th>Course</th>
          <th>Role</th>
          <th>Password</th>
          <th>Action</th>
        </tr>
      </thead>
        </table>
      </div>

    </div>
    <center><button class="my-btn" onclick="window.location.href='admin-welcome.html'">Back</button></center>
    
  </div>

  

  <script>
  async function loadPendingRequests() {
    try {
      const response = await fetch("http://localhost:8080/api/details");
      if (!response.ok) {
        throw new Error("Failed to fetch pending requests: " + response.status);
      }
      const students = await response.json();

      const table = document.getElementById("usersTable");
      table.innerHTML = `
        <thead>
          <tr>
            <th>Name</th>
            <th>Register No</th>
            <th>Email</th>
            <th>Year</th>
            <th>Department</th>
            <th>Course</th>
            <th>Role</th>
            <th>Password</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody></tbody>
      `;

      const tableBody = table.querySelector("tbody");

      students.forEach(student => {
        const row = document.createElement("tr");
        row.setAttribute("data-id", student.id); // ‚úÖ important

        row.innerHTML = `
          <td class="name">${student.name || '-'}</td>
          <td class="username">${student.username || '-'}</td>
          <td class="email">${student.email || '-'}</td>
          <td class="year">${student.year || '-'}</td>
          <td class="department">${student.department || '-'}</td>
          <td class="course">${student.course || '-'}</td>
          <td class="role">${student.role || '-'}</td>
          <td class="password">${student.password || '-'}</td>
          <td>
            <button class="btn edit" onclick="enableEdit(${student.id})">‚úèÔ∏è Edit</button>
            <button class="btn delete" onclick="onDelete(${student.id})">üóë Delete</button>
          </td>
        `;
        tableBody.appendChild(row);
      });
    } catch (error) {
      console.error("Error loading pending requests:", error);
      alert("Error loading pending requests.");
    }
  }

  function enableEdit(id) {
    const row = document.querySelector(`tr[data-id='${id}']`);
    ["name","username","email","year","department","course","role","password"].forEach(field => {
      const cell = row.querySelector(`.${field}`);
      const value = cell.innerText;
      cell.innerHTML = `<input class="inline-edit" type="text" value="${value}">`;
    });

    const actionCell = row.querySelector("td:last-child");
    actionCell.innerHTML = `
      <button class="save" onclick="saveEdit(${id})">üíæ Save</button>
      <button class="cancel" onclick="loadPendingRequests()">‚ùå Cancel</button>
    `;
  }

  async function saveEdit(id) {
    const row = document.querySelector(`tr[data-id='${id}']`);
    const updatedData = {
      id,
      name: row.querySelector(".name input").value,
      username: row.querySelector(".username input").value,
      email: row.querySelector(".email input").value,
      year: row.querySelector(".year input").value,
      department: row.querySelector(".department input").value,
      course: row.querySelector(".course input").value,
      role: row.querySelector(".role input").value,
      password: row.querySelector(".password input").value
    };

    try {
      const response = await fetch(`http://localhost:8080/api/updatedstudent/${id}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(updatedData)
      });

      if (!response.ok) throw new Error("Update failed: " + response.status);
      alert("User updated successfully!");
      loadPendingRequests();
    } catch (error) {
      console.error("Error saving user:", error);
      alert("Error updating user.");
    }
  }

  // Load data when page opens
  window.onload = loadPendingRequests;
</script>

  
</body>
</html>
